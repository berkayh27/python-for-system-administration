{
    "version": 3,
    "terraform_version": "0.11.7",
    "serial": 41,
    "lineage": "7a84da43-00da-bb15-2b08-500426087e44",
    "modules": [
        {
            "path": [
                "root"
            ],
            "outputs": {},
            "resources": {
                "aws_cloudwatch_event_rule.console": {
                    "type": "aws_cloudwatch_event_rule",
                    "depends_on": [],
                    "primary": {
                        "id": "capture-sec-groups",
                        "attributes": {
                            "arn": "arn:aws:events:us-east-1:607546651489:rule/capture-sec-groups",
                            "description": "Capture each Security Groups More Granular",
                            "event_pattern": "{\"detail\":{\"eventName\":[\"CreateSecurityGroup\",\"AuthorizeSecurityGroupIngress\",\"AuthorizeSecurityGroupEgress\",\"RevokeSecurityGroupIngress\",\"RevokeSecurityGroupEgress\"],\"eventSource\":[\"ec2.amazonaws.com\"]},\"detail-type\":[\"AWS API Call via CloudTrail\"],\"source\":[\"aws.ec2\"]}",
                            "id": "capture-sec-groups",
                            "is_enabled": "true",
                            "name": "capture-sec-groups",
                            "role_arn": "",
                            "schedule_expression": "",
                            "tags.%": "0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.aws"
                },
                "aws_cloudwatch_event_target.sns": {
                    "type": "aws_cloudwatch_event_target",
                    "depends_on": [
                        "aws_cloudwatch_event_rule.console"
                    ],
                    "primary": {
                        "id": "capture-sec-groups-SendToSNS",
                        "attributes": {
                            "arn": "arn:aws:sns:us-east-1:607546651489:email_from_security_groups",
                            "id": "capture-sec-groups-SendToSNS",
                            "input": "",
                            "input_path": "",
                            "input_transformer.#": "1",
                            "input_transformer.0.input_paths.%": "4",
                            "input_transformer.0.input_paths.name": "$.detail.requestParameters.groupId",
                            "input_transformer.0.input_paths.source": "$.detail.eventName",
                            "input_transformer.0.input_paths.time": "$.time",
                            "input_transformer.0.input_paths.value": "$.detail",
                            "input_transformer.0.input_template": "\"User  has executed API call  from source  on security group \u003cname\u003e that belongs to vpc  in region  at time(UTC) \u003ctime\u003e. .\"",
                            "role_arn": "",
                            "rule": "capture-sec-groups",
                            "target_id": "SendToSNS"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.aws"
                },
                "aws_sns_topic.aws_logins": {
                    "type": "aws_sns_topic",
                    "depends_on": [],
                    "primary": {
                        "id": "arn:aws:sns:us-east-1:607546651489:aws-console-logins",
                        "attributes": {
                            "application_failure_feedback_role_arn": "",
                            "application_success_feedback_role_arn": "",
                            "arn": "arn:aws:sns:us-east-1:607546651489:aws-console-logins",
                            "delivery_policy": "",
                            "display_name": "",
                            "http_failure_feedback_role_arn": "",
                            "http_success_feedback_role_arn": "",
                            "id": "arn:aws:sns:us-east-1:607546651489:aws-console-logins",
                            "kms_master_key_id": "",
                            "lambda_failure_feedback_role_arn": "",
                            "lambda_success_feedback_role_arn": "",
                            "name": "aws-console-logins",
                            "policy": "{\"Version\":\"2008-10-17\",\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Sid\":\"__default_statement_ID\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Action\":[\"SNS:GetTopicAttributes\",\"SNS:SetTopicAttributes\",\"SNS:AddPermission\",\"SNS:RemovePermission\",\"SNS:DeleteTopic\",\"SNS:Subscribe\",\"SNS:ListSubscriptionsByTopic\",\"SNS:Publish\",\"SNS:Receive\"],\"Resource\":\"arn:aws:sns:us-east-1:607546651489:aws-console-logins\",\"Condition\":{\"StringEquals\":{\"AWS:SourceOwner\":\"607546651489\"}}}]}",
                            "sqs_failure_feedback_role_arn": "",
                            "sqs_success_feedback_role_arn": "",
                            "tags.%": "0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.aws"
                }
            },
            "depends_on": []
        }
    ]
}
